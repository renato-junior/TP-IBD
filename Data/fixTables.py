#!/usr/bin/python3
import csv, sys, random, collections
import MySQLdb, getpass, os

db = MySQLdb.connect(host="localhost",    # your host, usually localhost
                     user="root",         # your username
                     passwd=getpass.getpass("Insira senha\n"),  # your password
                     db="GameSingle")        # name of the data base

cur = db.cursor()
query = "UPDATE Game SET ID = %s,Name = \"%s\",ReleaseDate = %s,RequiredAge = %s,DemoCount = %s,DeveloperCount = %s,DLCCount = %s,Metacritic = %s,MovieCount = %s,PackageCount = %s,RecommendationCount = %s,PublisherCount = %s,ScreenshotCount = %s,SteamSpyOwners = %s,SteamSpyOwnersVariance = %s,SteamSpyPlayersEstimate = %s,SteamSpyPlayersVariance = %s,AchievementCount = %s,AchievementHighlightedCount = %s,ControllerSupport = %s,IsFree = %s,FreeVerAvail = %s,PurchaseAvail = %s,SubscriptionAvail = %s,PlatformWindows = %s,PlatformLinux = %s,PlatformMac = %s,PCReqsHaveMin = %s,PCReqsHaveRec = %s,LinuxReqsHaveMin = %s,LinuxReqsHaveRec = %s,MacReqsHaveMin = %s,MacReqsHaveRec = %s,CategorySinglePlayer = %s,CategoryMultiplayer = %s,CategoryCoop = %s,CategoryMMO = %s,CategoryInAppPurchase = %s,CategoryIncludeSrcSDK = %s,CategoryIncludeLevelEditor = %s,CategoryVRSupport = %s,GenreIsNonGame = %s,GenreIsIndie = %s,GenreIsAction = %s,GenreIsAdventure = %s,GenreIsCasual = %s,GenreIsStrategy = %s,GenreIsRPG = %s,GenreIsSimulation = %s,GenreIsEarlyAccess = %s,GenreIsFreeToPlay = %s,GenreIsSports = %s,GenreIsRacing = %s,GenreIsMassivelyMultiplayer = %s,PriceCurrency = %s,PriceInitial = %s,PriceFinal = %s,SupportEmail = %s,SupportURL = %s,AboutText = %s,Background = %s,ShortDescrip = %s,DetailedDescrip = %s,DRMNotice = %s,ExtUserAcctNotice = %s,HeaderImage = %s,LegalNotice = %s,Reviews = %s,SupportedLanguages = %s,Website = %s,PCMinReqsText = %s,PCRecReqsText = %s,LinuxMinReqsText = %s,LinuxRecReqsText = %s,MacMinReqsText = %s,MacRecReqsText = %s where ID = %s"

with open('nameswithcomma.csv') as csvfile:
	file = csv.DictReader(csvfile)
	for line in file:
		args = (line["ID"][:255].encode('latin-1', "ignore"),line["Name"][:255].encode('latin-1', "ignore"),line["ReleaseDate"][:255].encode('latin-1', "ignore"),line["RequiredAge"][:255].encode('latin-1', "ignore"),line["DemoCount"][:255].encode('latin-1', "ignore"),line["DeveloperCount"][:255].encode('latin-1', "ignore"),line["DLCCount"][:255].encode('latin-1', "ignore"),line["Metacritic"][:255].encode('latin-1', "ignore"),line["MovieCount"][:255].encode('latin-1', "ignore"),line["PackageCount"][:255].encode('latin-1', "ignore"),line["RecommendationCount"][:255].encode('latin-1', "ignore"),line["PublisherCount"][:255].encode('latin-1', "ignore"),line["ScreenshotCount"][:255].encode('latin-1', "ignore"),line["SteamSpyOwners"][:255].encode('latin-1', "ignore"),line["SteamSpyOwnersVariance"][:255].encode('latin-1', "ignore"),line["SteamSpyPlayersEstimate"][:255].encode('latin-1', "ignore"),line["SteamSpyPlayersVariance"][:255].encode('latin-1', "ignore"),line["AchievementCount"][:255].encode('latin-1', "ignore"),line["AchievementHighlightedCount"][:255].encode('latin-1', "ignore"),line["ControllerSupport"][:255].encode('latin-1', "ignore"),line["IsFree"][:255].encode('latin-1', "ignore"),line["FreeVerAvail"][:255].encode('latin-1', "ignore"),line["PurchaseAvail"][:255].encode('latin-1', "ignore"),line["SubscriptionAvail"][:255].encode('latin-1', "ignore"),line["PlatformWindows"][:255].encode('latin-1', "ignore"),line["PlatformLinux"][:255].encode('latin-1', "ignore"),line["PlatformMac"][:255].encode('latin-1', "ignore"),line["PCReqsHaveMin"][:255].encode('latin-1', "ignore"),line["PCReqsHaveRec"][:255].encode('latin-1', "ignore"),line["LinuxReqsHaveMin"][:255].encode('latin-1', "ignore"),line["LinuxReqsHaveRec"][:255].encode('latin-1', "ignore"),line["MacReqsHaveMin"][:255].encode('latin-1', "ignore"),line["MacReqsHaveRec"][:255].encode('latin-1', "ignore"),line["CategorySinglePlayer"][:255].encode('latin-1', "ignore"),line["CategoryMultiplayer"][:255].encode('latin-1', "ignore"),line["CategoryCoop"][:255].encode('latin-1', "ignore"),line["CategoryMMO"][:255].encode('latin-1', "ignore"),line["CategoryInAppPurchase"][:255].encode('latin-1', "ignore"),line["CategoryIncludeSrcSDK"][:255].encode('latin-1', "ignore"),line["CategoryIncludeLevelEditor"][:255].encode('latin-1', "ignore"),line["CategoryVRSupport"][:255].encode('latin-1', "ignore"),line["GenreIsNonGame"][:255].encode('latin-1', "ignore"),line["GenreIsIndie"][:255].encode('latin-1', "ignore"),line["GenreIsAction"][:255].encode('latin-1', "ignore"),line["GenreIsAdventure"][:255].encode('latin-1', "ignore"),line["GenreIsCasual"][:255].encode('latin-1', "ignore"),line["GenreIsStrategy"][:255].encode('latin-1', "ignore"),line["GenreIsRPG"][:255].encode('latin-1', "ignore"),line["GenreIsSimulation"][:255].encode('latin-1', "ignore"),line["GenreIsEarlyAccess"][:255].encode('latin-1', "ignore"),line["GenreIsFreeToPlay"][:255].encode('latin-1', "ignore"),line["GenreIsSports"][:255].encode('latin-1', "ignore"),line["GenreIsRacing"][:255].encode('latin-1', "ignore"),line["GenreIsMassivelyMultiplayer"][:255].encode('latin-1', "ignore"),line["PriceCurrency"][:255].encode('latin-1', "ignore"),line["PriceInitial"][:255].encode('latin-1', "ignore"),line["PriceFinal"][:255].encode('latin-1', "ignore"),line["SupportEmail"][:255].encode('latin-1', "ignore"),line["SupportURL"][:255].encode('latin-1', "ignore"),line["AboutText"][:255].encode('latin-1', "ignore"),line["Background"][:255].encode('latin-1', "ignore"),line["ShortDescrip"][:255].encode('latin-1', "ignore"),line["DetailedDescrip"][:255].encode('latin-1', "ignore"),line["DRMNotice"][:255].encode('latin-1', "ignore"),line["ExtUserAcctNotice"][:255].encode('latin-1', "ignore"),line["HeaderImage"][:255].encode('latin-1', "ignore"),line["LegalNotice"][:255].encode('latin-1', "ignore"),line["Reviews"][:255].encode('latin-1', "ignore"),line["SupportedLanguages"][:255].encode('latin-1', "ignore"),line["Website"][:255].encode('latin-1', "ignore"),line["PCMinReqsText"][:255].encode('latin-1', "ignore"),line["PCRecReqsText"][:255].encode('latin-1', "ignore"),line["LinuxMinReqsText"][:255].encode('latin-1', "ignore"),line["LinuxRecReqsText"][:255].encode('latin-1', "ignore"),line["MacMinReqsText"][:255].encode('latin-1', "ignore"),line["MacRecReqsText"][:255].encode('latin-1', "ignore"), line["ID"][:255].encode('latin-1', "ignore"))
		try:
			cur.execute(query, args)
			db.commit()
		except (MySQLdb.Error, MySQLdb.Warning) as e:
			print(e)

db.close()

db = MySQLdb.connect(host="localhost",    # your host, usually localhost
                     user="root",         # your username
                     passwd=getpass.getpass("Insira senha\n"),  # your password
                     db="GameMultiple")        # name of the data base

cur = db.cursor()
query = "UPDATE Game SET ID = %s,Name = %s,ReleaseDate = %s,RequiredAge = %s,DemoCount = %s,DeveloperCount = %s,DLCCount = %s,Metacritic = %s,MovieCount = %s,PackageCount = %s,RecommendationCount = %s,PublisherCount = %s,ScreenshotCount = %s,SteamSpyOwners = %s,SteamSpyOwnersVariance = %s,SteamSpyPlayersEstimate = %s,SteamSpyPlayersVariance = %s,AchievementCount = %s,AchievementHighlightedCount = %s,ControllerSupport = %s,IsFree = %s,FreeVerAvail = %s,PurchaseAvail = %s,SubscriptionAvail = %s,PriceCurrency = %s,PriceInitial = %s,PriceFinal = %s,SupportEmail = %s,SupportURL = %s,AboutText = %s,Background = %s,ShortDescrip = %s,DetailedDescrip = %s,DRMNotice = %s,ExtUserAcctNotice = %s,HeaderImage = %s,LegalNotice = %s,Reviews = %s,SupportedLanguages = %s,Website = %s where ID = %s"

with open('nameswithcomma.csv') as csvfile:
	file = csv.DictReader(csvfile)
	for line in file:
		args = (line["ID"][:255].encode('latin-1','ignore'),line["Name"][:255].encode('latin-1','ignore'),line["ReleaseDate"][:255].encode('latin-1','ignore'),line["RequiredAge"][:255].encode('latin-1','ignore'),line["DemoCount"][:255].encode('latin-1','ignore'),line["DeveloperCount"][:255].encode('latin-1','ignore'),line["DLCCount"][:255].encode('latin-1','ignore'),line["Metacritic"][:255].encode('latin-1','ignore'),line["MovieCount"][:255].encode('latin-1','ignore'),line["PackageCount"][:255].encode('latin-1','ignore'),line["RecommendationCount"][:255].encode('latin-1','ignore'),line["PublisherCount"][:255].encode('latin-1','ignore'),line["ScreenshotCount"][:255].encode('latin-1','ignore'),line["SteamSpyOwners"][:255].encode('latin-1','ignore'),line["SteamSpyOwnersVariance"][:255].encode('latin-1','ignore'),line["SteamSpyPlayersEstimate"][:255].encode('latin-1','ignore'),line["SteamSpyPlayersVariance"][:255].encode('latin-1','ignore'),line["AchievementCount"][:255].encode('latin-1','ignore'),line["AchievementHighlightedCount"][:255].encode('latin-1','ignore'),line["ControllerSupport"][:255].encode('latin-1','ignore'),line["IsFree"][:255].encode('latin-1','ignore'),line["FreeVerAvail"][:255].encode('latin-1','ignore'),line["PurchaseAvail"][:255].encode('latin-1','ignore'),line["SubscriptionAvail"][:255].encode('latin-1','ignore'),line["PriceCurrency"][:255].encode('latin-1','ignore'),line["PriceInitial"][:255].encode('latin-1','ignore'),line["PriceFinal"][:255].encode('latin-1','ignore'),line["SupportEmail"][:255].encode('latin-1','ignore'),line["SupportURL"][:255].encode('latin-1','ignore'),line["AboutText"][:255].encode('latin-1','ignore'),line["Background"][:255].encode('latin-1','ignore'),line["ShortDescrip"][:255].encode('latin-1','ignore'),line["DetailedDescrip"][:255].encode('latin-1','ignore'),line["DRMNotice"][:255].encode('latin-1','ignore'),line["ExtUserAcctNotice"][:255].encode('latin-1','ignore'),line["HeaderImage"][:255].encode('latin-1','ignore'),line["LegalNotice"][:255].encode('latin-1','ignore'),line["Reviews"][:255].encode('latin-1','ignore'),line["SupportedLanguages"][:255].encode('latin-1','ignore'),line["Website"][:255].encode('latin-1','ignore'),line["ID"][:255].encode('latin-1','ignore'))
		try:
			cur.execute(query, args)
			db.commit()
		except (MySQLdb.Error, MySQLdb.Warning) as e:
			print(e)

db.close()